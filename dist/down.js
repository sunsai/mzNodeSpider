"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}Object.defineProperty(exports,"__esModule",{value:!0});var _config=require("./config"),config=_interopRequireWildcard(_config),http=require("http"),request=require("superagent"),fs=require("fs"),async=require("async"),progress=require("progress"),url=require("url"),down=function(e){var r={remote:e.href,filename:e.title+".mp4"},t=r.remote,o=r.filename,n=fs.createWriteStream(config.saveDir+o);({host:url.parse(t).host,port:80,path:url.parse(t).pathname});n.on("error",function(e){console.log("write error - %s",e.message)});request.get(t).end(function(e,r){if(e)throw e;var t=parseInt(r.headers["content-length"]),i=new progress("  downloading [:bar] :percent :etas",{complete:"=",incomplete:" ",width:20,total:t});r.on("data",function(e){i.tick(e.length),n.write(e)}).on("end",function(){n.end(),console.log(o+" downloaded to ")}).on("error",function(e){throw e})})};exports.default=down;